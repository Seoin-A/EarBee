{{>layouts/header}}

<div class="business">
    <form>
        <table>
            <tr>
                <td colspan="3"><label style="margin-bottom: 5px">사업자 번호</label></td>
            </tr>
            <tr>
                <td>
                    <div class="mb-3 ">
                        <input name="businessNumber" type="text" class="form-control" readonly>
                    </div>
                </td>
                <td>
                    <div class="mb-3">
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#Modal"
                                data-bs-name='사업자 번호 조회' data-bs-type="business">조회
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="3">주소</td>
            </tr>
            <tr>
                <td>
                    <div class="mb-3 ">
                        <input name="businessNumber" type="text" class="form-control" readonly>
                    </div>
                </td>
                <td>
                    <div class="mb-3">
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#Modal"
                                data-bs-name='주소 조회' data-bs-type="address">조회
                        </button>
                    </div>
                </td>
            </tr>
        </table>
    </form>
</div>

<!-- 모달창 -->


<div class="modal fade" id="Modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="selectName">#</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="searchType" datatype="null">
                    <div class="mb-3">
                        <input type="text" class="form-control" id="inputNumber">
                    </div>
                    <div style="float:right">
                        <button type="button" class="btn btn-primary" onclick="search()">조회</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<script>

    {   // 모달창 이벤트
        const Modal = document.getElementById('Modal');

        if (Modal) {
            Modal.addEventListener('show.bs.modal', event => {

                // 트리거 버튼 찾기
                const button = event.relatedTarget;

                // 데이터 가져오기
                const modalType = button.getAttribute("data-bs-type");

                // 모달창에 데이터 반영
                document.querySelector('#selectName').innerText = button.getAttribute("data-bs-name");

                // type 별로 placeholder 바꾸기 및 현재 폼이 어떤 RestApi을 호출할 것인지 form에 data-sort-type을 지정함
                if(modalType !== 'business'){
                    document.querySelector('#inputNumber').removeAttribute("placeholder");
                    document.querySelector('#searchType').setAttribute('data-sort-type','null')
                }else{
                    document.querySelector('#inputNumber').setAttribute('placeholder',"- 제거해서 입력해주세요");
                    document.querySelector('#searchType').setAttribute('data-sort-type','businessNum')
                    document.querySelector('#inputNumber').setAttribute('type','number');
                }

            })
        }
    }

    function search(){
        const dataSortType = document.querySelector('#searchType').getAttribute('data-sort-type');
        const businessNum = document.querySelector('#inputNumber').value;

        if(dataSortType !== 'businessNum'){
            
           return false
        }
        const url = "/api/business/search";
        const body = {
            intNumber : businessNum
        }
        fetch(url,{
            method : "post",
            body : JSON.stringify(body),
            headers :{
                "Content-Type" : "application/json"
            }
        }).then(response => {
            console.log('ok');
        })



    }

</script>

<style>
    .business {
        margin: 0;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid black;
    }

</style>

{{>layouts/footer}}